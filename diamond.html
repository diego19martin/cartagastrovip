<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Carta Gastronómica Diamond</title>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <script type="module" src="js/logUsage.js"></script> <!-- Importa tu archivo de funciones -->
    <style>
      body {
        font-family: "Roboto", sans-serif;
        margin: 10;
        padding: 20px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: flex-start;
        min-height: 100vh;
        background: linear-gradient(0deg, #000000, #6d0493);
        color: white;
      }
      .vip-title {
        text-align: center;
        margin-bottom: 20px;
      }
      .vip-title h1 {
        font-size: 3em;
        margin: 0;
        color: #ffda44;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
      }
      .alert-message {
        display: none;
        color: #ff4444;
        background: #ffcccc;
        border-radius: 5px;
        padding: 10px;
        margin-bottom: 20px;
        text-align: center;
        width: 100%;
        box-shadow: 0 4px 8px rgba(255, 68, 68, 0.2);
      }
      .game-name {
        font-size: 1.5em;
        color: #ffda44;
        margin-bottom: 10px;
        text-align: center;
      }
      .menu {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        text-align: center;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        border-radius: 10px;
        overflow: hidden;
        background: rgba(0, 0, 0, 0.6);
        padding: 20px;
        max-width: 90%;
        margin-bottom: 20px;
      }
      .menu img {
        max-width: 100%;
        height: auto;
        transition: transform 0.3s;
      }
      .menu img:hover {
        transform: scale(1.05);
      }
      .steps {
        display: flex;
        flex-direction: column;
        align-items: center;
        width: 100%;
        margin-bottom: 20px;
      }
      .steps h3 {
        margin-bottom: 10px;
        font-size: 1.5em;
        color: #ffda44;
      }
      .step {
        display: flex;
        align-items: center;
        margin-bottom: 10px;
        padding: 10px;
        border: 2px solid #fff;
        border-radius: 10px;
        width: 100%;
        background-color: rgba(255, 255, 255, 0.1);
      }
      .step-number {
          background-color: #fff;
          color: #000;
          border-radius: 50%;
          width: 40px; /* Un poco más grande para acomodar el icono */
          height: 40px;
          display: flex;
          align-items: center;
          justify-content: center;
          margin-right: 10px;
          font-size: 1.2em; /* Ajusta el tamaño del ícono */
          line-height: 1; /* Asegura que el icono esté centrado verticalmente */
      }

.step-number i {
    font-size: 1.2em; /* Ajusta el tamaño del ícono */
}



      .step-text {
        display: flex;
        align-items: center;
      }
      .step-text i {
        margin-right: 10px;
        font-size: 1.2em;
      }
      .location-info {
        margin-top: 20px;
        text-align: center;
      }
      .input-container {
        margin-top: 20px;
        text-align: center;
        width: 100%;
      }
      .input-container input,
      .input-container textarea {
        padding: 10px;
        font-size: 1em;
        width: calc(100% - 22px); /* Para considerar padding */
        margin-bottom: 10px;
        border-radius: 5px;
        border: none;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      }
      .input-container .confirm-message {
        color: #ffd600;
        display: none;
        margin-top: 10px;
        background-color: blueviolet;
        border-radius: 10px;
      }
      .next-step {
        color: #ffffff;
        margin-top: 10px;
        display: none;
        background-color: darkorchid;
        border-radius: 9px;
        padding: 10px;
      }
      .input-container button {
        padding: 10px 20px;
        font-size: 1em;
        background-color: #25d366;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        width: 100%;
        transition: background-color 0.3s, transform 0.3s;
      }
      .input-container button:hover {
        background-color: #1da354;
        transform: scale(1.05);
      }
      .whatsapp-icon {
        background-color: #ccc; /* Color gris antes de habilitarse */
        border-radius: 50%;
        width: 60px;
        height: 60px;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        transition: transform 0.3s, background-color 0.3s;
        margin-top: 20px;
      }
      .whatsapp-icon a {
        color: white;
        font-size: 2em;
        pointer-events: none; /* Deshabilita el enlace */
      }
      .whatsapp-icon.enabled {
        background-color: #25d366; /* Color verde cuando se habilita */
        animation: pulse 1s infinite;
      }
      .whatsapp-icon.enabled a {
        pointer-events: auto; /* Habilita el enlace */
      }
      @keyframes pulse {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.1);
        }
        100% {
          transform: scale(1);
        }
      }
      .section {
        margin-top: 20px;
        text-align: center;
        width: 100%;
        padding: 20px;
        background: rgba(255, 255, 255, 0.1);
        border: 2px solid #ffda44;
        border-radius: 10px;
        margin-bottom: 20px;
        display: none; /* Oculta la sección inicialmente */
      }

      .section-gastro {
        display: none;
      }

      .section h3 {
        font-size: 1.5em;
        color: #ffda44;
        margin-bottom: 10px;
      }
      .whatsapp-icon-assistance,
      .whatsapp-icon-ticket,
      .whatsapp-icon-service {
        margin: 0 auto;
      }
      .whatsapp-icon-cleaning {
        margin: 0 auto;
      }
      .items-container {
        text-align: left;
        margin: 20px 0;
        padding: 20px;
        background: rgba(0, 0, 0, 0.6);
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      }
      .items-container h3 {
        font-size: 1.5em;
        color: #ffda44;
        margin-bottom: 10px;
      }
      .items-column {
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
      }
      .items-column div {
        width: 100%;
      }
      .items-column h4 {
        color: #ffda44;
        margin-bottom: 5px;
        border-bottom: 1px solid #ffda44;
      }
      .items-column label {
        display: block;
        margin-bottom: 5px;
      }
      #order-section {
        display: none;
        width: 100%;
      }
      .show-order-button {
        padding: 10px 20px;
        font-size: 1.2em;
        background-color: #25d366;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        margin-bottom: 20px;
        transition: background-color 0.3s, transform 0.3s;
        animation: pulse 1s infinite; /* Añadir la animación de escala */
      }

      .show-order-button:hover {
        background-color: #1da354;
        transform: scale(1.05);
      }
      .chatbot-section {
        margin-top: 20px;
        text-align: center;
        width: 100%;
        padding: 20px;
        background: #9a00ae;
        border: 2px solid #ffffff;
        border-radius: 10px;
        margin-bottom: 20px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
      }
      .chatbot-section h3 {
        color: #ffffff;
        background: linear-gradient(135deg, #e0c3fc 0%, #540169 100%);
        border-radius: 15px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        font-size: 1.8em;
        margin-bottom: 15px;
        padding: 20px;
      }
      .whatsapp-icon-sloti {
        margin: 0 auto;
        animation: glow 1.5s infinite;
      }
      @keyframes glow {
        0% {
          box-shadow: 0 0 5px #28a745;
        }
        50% {
          box-shadow: 0 0 20px #28a745;
        }
        100% {
          box-shadow: 0 0 5px #28a745;
        }
      }
      .sloti-image {
        display: block;
        max-width: 150px;
        height: auto;
        border-radius: 5%;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        margin: 20px auto;
      }
      .sloti-description {
        color: #ffffff;
        font-size: 1em;
        margin: 10px 0;
        text-align: center;
      }

      .betfun-section {
        margin-top: 20px;
        text-align: center;
        width: 100%;
        padding: 20px;
        background-image: url("./img/bgbetfun.png"); /* Imagen de fondo proporcionada */
        background-size: cover; /* Ajusta el tamaño para cubrir toda la sección */
        background-position: center; /* Centra la imagen de fondo */
        border: 2px solid #ffffff;
        border-radius: 10px;
        margin-bottom: 20px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        animation: backgroundGlow 5s infinite alternate; /* Animación de fondo */
      }

      .betfun-section h3 {
        color: #ffffff;
        font-size: 1.8em;
        margin-bottom: 10px;
        font-weight: bold;
        text-transform: uppercase;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
      }

      .betfun-section p {
        color: #b0b0b0;
        margin-bottom: 15px;
        font-size: 1em;
      }

      .betfun-image {
        display: block;
        max-width: 100px;
        height: auto;
        border-radius: 10%;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        margin: 10px auto;
        transition: transform 0.3s, filter 0.3s;
        animation: betfunIconGlow 1.5s infinite alternate; /* Añadir animación de iluminación */
      }

      .betfun-image:hover {
        transform: scale(1.1);
        filter: brightness(1.3); /* Mayor brillo al pasar el ratón */
      }

      .whatsapp-icon-betfun {
        background-color: #25d366; /* Color verde desde el inicio */
        border-radius: 50%;
        width: 60px;
        height: 60px;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        transition: transform 0.3s, background-color 0.3s;
        margin-top: 20px;
        animation: glow 1.5s infinite; /* Aplicar animación para iluminar */
      }

      .whatsapp-icon-betfun a {
        color: white;
        font-size: 2em;
        pointer-events: auto; /* Habilita el enlace desde el inicio */
      }

      .salado-columns {
        display: grid;
        grid-template-columns: 1fr 1fr; /* Divide el espacio en dos columnas iguales */
        gap: 10px; /* Espacio entre las columnas */
      }

      .salado-columns div {
        width: 100%; /* Cada columna ocupa todo el ancho disponible en su grid */
      }

      .salado-columns label {
        display: block;
        margin-bottom: 5px;
      }

      @keyframes glow {
        0% {
          box-shadow: 0 0 5px #28a745;
        }
        50% {
          box-shadow: 0 0 20px #28a745;
        }
        100% {
          box-shadow: 0 0 5px #28a745;
        }
      }

      @keyframes betfunIconGlow {
        0% {
          filter: brightness(1);
        }
        100% {
          filter: brightness(1.5);
        }
      }

      @keyframes backgroundGlow {
        0% {
          background-color: rgba(
            0,
            0,
            0,
            0.5
          ); /* Efecto inicial de iluminación tenue */
        }
        100% {
          background-color: rgba(
            0,
            0,
            0,
            0.8
          ); /* Efecto final de iluminación */
        }
      }
    </style>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <script>
      let machineData = null; // Variable para almacenar los datos de la máquina

      const getInfo = async (machineId) => {
        try {
          const response = await axios.get(
            `https://ubicacion-maquinas.herokuapp.com/ubicacion/${machineId}`
          );
          return response.data;
        } catch (error) {
          console.error("Error fetching machine info:", error);
          return null;
        }
      };

      const updateWhatsAppLink = (

        machineId,
        nombre,
        ubicacion,
        customLocation = ""
      ) => {
        const locationText = customLocation
          ? `la ubicación: *${customLocation}*`
          : `Ubicada en: *${ubicacion}*`;
        const selectedItems = Array.from(
          document.querySelectorAll(
            '.items-container input[type="checkbox"]:checked'
          )
        )
          .map((item) => item.value)
          .join(", ");

        //Gastronomía

        let messagePedido;

        if (customLocation) {
          messagePedido = `Hola! 👋\n\nSoy Diamond! \n\nNecesito hacer un pedido en ${locationText}.\n\nPedido: ${selectedItems}.\n\nGracias! 😊`;
        } else if (machineId && nombre) {
          messagePedido = `Hola! 👋\n\nSoy Diamond! \n\nNecesito hacer un pedido en la máquina 🎰 *${machineId}*.\nJuego: *${nombre}*.\n${locationText}.\n\nPedido: ${selectedItems}.\n\nGracias! 😊`;
        } else {
          messagePedido = `Hola! 👋\n\nSoy Diamond! \n\nNecesito hacer un pedido en la máquina 🎰 *${machineId}*.\n${locationText}.\n\nPedido: ${selectedItems}.\n\nGracias! 😊`;
        }

        const whatsappLinkPedido = document.querySelector(
          ".whatsapp-icon-service a"
        );
        whatsappLinkPedido.href = `https://wa.me/541121632583?text=${encodeURIComponent(
          messagePedido
        )}`;
        const whatsappIconPedido = document.querySelector(
          ".whatsapp-icon-service"
        );
        whatsappIconPedido.classList.add("enabled"); // Habilita el enlace de WhatsApp para pedidos

        // Botón de Sloti siempre habilitado
        const whatsappIconSloti = document.querySelector(
          ".whatsapp-icon-sloti"
        );
        whatsappIconSloti.classList.add("enabled"); // Habilita el enlace de WhatsApp para Sloti
        const whatsappLinkSloti = document.querySelector(
          ".whatsapp-icon-sloti a"
        );
        whatsappLinkSloti.href = `https://wa.me/541166798216?text=Hola Sloti! 👋`;

        // Habilitar los otros botones según la validación de la máquina o ubicación
        if (machineId || customLocation) {
          let messageCleaning;
          const whatsappLinkCleaning = document.querySelector(
            ".whatsapp-icon-cleaning a"
          );
          whatsappLinkCleaning.href = `https://wa.me/541157124933?text=${encodeURIComponent(
            messageCleaning
          )}`;
          const whatsappIconCleaning = document.querySelector(
            ".whatsapp-icon-cleaning"
          );
          whatsappIconCleaning.classList.add("enabled"); // Habilita el enlace de WhatsApp para limpieza
        }

        //Prefer

        let messageAsistencia;

        if (customLocation) {
          messageAsistencia = `Hola! 👋\n\nSoy Diamond! \n\nNecesito asistencia Prefer en \n${locationText}.\n\nGracias! 😊`;
        } else if (machineId && nombre) {
          messageAsistencia = `Hola! 👋\n\nSoy Diamond! \n\nNecesito asistencia Prefer desde la máquina 🎰 *${machineId}*.\nJuego: *${nombre}*.\n${locationText}.\n\nGracias! 😊`;
        }

        const whatsappLinkAsistencia = document.querySelector(
          ".whatsapp-icon-assistance a"
        );
        whatsappLinkAsistencia.href = `https://wa.me/541122217990?text=${encodeURIComponent(
          messageAsistencia
        )}`;
        const whatsappIconAssistance = document.querySelector(
          ".whatsapp-icon-assistance"
        );

        whatsappIconAssistance.classList.add("enabled"); // Habilita el enlace de WhatsApp para asistencia

        //Juego
        let messageTicket;

        if (customLocation) {
          messageTicket = `Hola! 👋\n\nSoy Diamond! \n\nNecesito comprar tickets en \n${locationText}.\n\nGracias! 😊`;
        } else if (machineId && nombre) {
          messageTicket = `Hola! 👋\n\nSoy Diamond! \n\nNecesito comprar tickets desde la máquina 🎰 *${machineId}*.\nJuego: *${nombre}*.\n${locationText}.\n\nGracias! 😊`;
        }

        const whatsappLinkTicket = document.querySelector(
          ".whatsapp-icon-ticket a"
        );

        whatsappLinkTicket.href = `https://wa.me/541160971695?text=${encodeURIComponent(
          messageTicket
        )}`;

        const whatsappIconTicket = document.querySelector(
          ".whatsapp-icon-ticket"
        );

        whatsappIconTicket.classList.add("enabled"); // Habilita el enlace de WhatsApp para compra de tickets

        //Limpieza

        if (customLocation) {
          messageCleaning = `Hola! 👋\n\nSoy Diamond! \n\nNecesito solicitar servicio de Limpieza en \n${locationText}.\n\nGracias! 😊`;
        } else if (machineId && nombre) {
          messageCleaning = `Hola! 👋\n\nSoy Diamond! \n\nNecesito solicitar servicio de Limpieza desde la máquina 🎰 *${machineId}*.\nJuego: *${nombre}*.\n${locationText}.\n\nGracias! 😊`;
        }

        const whatsappLinkCleaning = document.querySelector(
          ".whatsapp-icon-cleaning a"
        );
        whatsappLinkCleaning.href = `https://wa.me/541135457224?text=${encodeURIComponent(
          messageCleaning
        )}`;
        const whatsappIconCleaning = document.querySelector(
          ".whatsapp-icon-cleaning"
        );
        whatsappIconCleaning.classList.add("enabled"); // Habilita el enlace de WhatsApp para limpieza
      };

      function checkInput(field) {
        const machineField = document.getElementById("machineId");
        const locationField = document.getElementById("customLocation");
        const confirmMessage = document.querySelector(".confirm-message");
        if (field === "machine" && machineField.value !== "") {
          locationField.disabled = true;
          locationField.placeholder = "Este campo está deshabilitado.";
          confirmMessage.style.display = "block";
          confirmMessage.textContent = "Ingresando número de máquina...";
        } else if (field === "location" && locationField.value !== "") {
          machineField.disabled = true;
          machineField.placeholder = "Este campo está deshabilitado.";
          confirmMessage.style.display = "block";
          confirmMessage.textContent = "Ingresando ubicación manual...";
        } else {
          machineField.disabled = false;
          locationField.disabled = false;
          machineField.placeholder = "Ingrese el número de la máquina";
          locationField.placeholder = "O ingrese su ubicación manualmente";
          confirmMessage.style.display = "none";
        }
      }

      function fetchMachineInfo() {

               

        const machineId = document.getElementById("machineId").value;
        const customLocation = document.getElementById("customLocation").value;

        
          function fetchMachineInfo() {
            Swal.fire({
              title: 'Ingrese el nombre del cliente (opcional)',
              input: 'text',
              inputPlaceholder: 'Nombre del cliente',
              showCancelButton: true,
              confirmButtonText: 'Confirmar',
              cancelButtonText: 'Omitir'
            }).then((result) => {
              const clientName = result.value || null; // Captura el nombre del cliente si se ingresó, o null si se omitió
            })
          }







        // Seleccionar todas las secciones que quieres mostrar
        const sections = document.querySelectorAll(".section");

        // Ocultar WhatsApp Icons al inicio
        const whatsappIconService = document.querySelector(
          ".whatsapp-icon-service"
        );
        whatsappIconService.classList.remove("enabled");
        const whatsappIconAssistance = document.querySelector(
          ".whatsapp-icon-assistance"
        );
        whatsappIconAssistance.classList.remove("enabled");
        const whatsappIconTicket = document.querySelector(
          ".whatsapp-icon-ticket"
        );
        whatsappIconTicket.classList.remove("enabled");
        const whatsappIconCleaning = document.querySelector(
          ".whatsapp-icon-cleaning"
        );
        whatsappIconCleaning.classList.remove("enabled");

        const nextStep = document.querySelector(".next-step");
        const confirmMessage = document.querySelector(".confirm-message");

        if (machineId || customLocation) {
          getInfo(machineId).then((data) => {
            if (data && data.nombre && data.ubicacion) {
              machineData = data;
              document.getElementById("alert-message").style.display = "none";
              document.getElementById(
                "game-name"
              ).textContent = `Usted está en la máquina: ${data.nombre}`;
              document.getElementById("game-name").style.display = "block";

              updateWhatsAppLink(
                machineId,
                data.nombre,
                data.ubicacion,
                customLocation
              );

               // Guardar el nombre de la máquina en la variable machineName
               const machineName = data.nombre;

              // Mostrar las secciones al confirmar la ubicación
              sections.forEach((section) => (section.style.display = "block"));

              nextStep.textContent =
                "Ahora, arme su pedido o presione el botón de WhatsApp para solicitar un servicio.";
              nextStep.style.display = "block";
            } else if (customLocation) {
              document.getElementById("alert-message").style.display = "none";
              document.getElementById("game-name").style.display = "none";

              updateWhatsAppLink(machineId, "", "", customLocation);
              confirmMessage.textContent = `Usted está en: ${customLocation}`;

              // Mostrar las secciones al confirmar la ubicación
              sections.forEach((section) => (section.style.display = "block"));

              nextStep.textContent =
                "Ahora, arme su pedido o presione el botón de WhatsApp para solicitar un servicio.";
              nextStep.style.display = "block";
            } else {
              machineData = null;
              document.getElementById("alert-message").textContent =
                "Error: No se encontraron datos de la máquina.";
              document.getElementById("alert-message").style.display = "block";
              document.getElementById("game-name").style.display = "none";
              nextStep.style.display = "none";
            }
          });
        }
      }

      document.addEventListener("DOMContentLoaded", function () {
        const urlParams = new URLSearchParams(window.location.search);
        const machineId = urlParams.get("machine_id");

        // Habilitar el botón de Sloti de inmediato, sin depender de la lógica de ubicación o máquina
        const whatsappIconSloti = document.querySelector(
          ".whatsapp-icon-sloti"
        );
        whatsappIconSloti.classList.add("enabled");
        const whatsappLinkSloti = document.querySelector(
          ".whatsapp-icon-sloti a"
        );
        whatsappLinkSloti.href = `https://wa.me/541166798216?text=Hola Sloti!`;

        if (machineId) {
          getInfo(machineId).then((data) => {
            if (data && data.nombre && data.ubicacion) {
              machineData = data; // Almacenar los datos de la máquina
              document.getElementById("alert-message").style.display = "none"; // Ocultar mensaje de alerta si existe
              document.getElementById(
                "game-name"
              ).textContent = `Juego: ${data.nombre}`;
              document.getElementById("game-name").style.display = "block";
              const locationElement = document.createElement("p");
              locationElement.textContent = `Ubicación de la máquina: ${data.ubicacion}`;
              document.querySelector(".menu").appendChild(locationElement);

              // Actualizar el enlace de WhatsApp
              updateWhatsAppLink(machineId, data.nombre, data.ubicacion);
            } else {
              machineData = null; // Reiniciar datos de la máquina
              document.getElementById("alert-message").textContent =
                "Error: No se encontraron datos de la máquina.";
              document.getElementById("alert-message").style.display = "block"; // Mostrar mensaje de alerta
              document.getElementById("game-name").style.display = "none"; // Ocultar nombre del juego
            }
          });
        }

        const img = document.querySelector(".menu img");
        img.addEventListener("error", function () {
          this.src = this.src; // Intentar recargar la imagen
        });

        // Añadir un evento a los checkboxes de la carta
        document
          .querySelectorAll('.items-container input[type="checkbox"]')
          .forEach((checkbox) => {
            checkbox.addEventListener("change", () => {
              const machineId =
                document.getElementById("machineId").value ||
                (machineData && machineData.id);
              const customLocation =
                document.getElementById("customLocation").value;

              // Verificar si hay al menos un ítem seleccionado
              const hasSelectedItems =
                Array.from(
                  document.querySelectorAll(
                    '.items-container input[type="checkbox"]:checked'
                  )
                ).length > 0;

              const sectionGastro = document.querySelector(".section-gastro");

              if (hasSelectedItems) {
                sectionGastro.style.display = "block"; // Muestra la sección gastronómica
              } else {
                sectionGastro.style.display = "none"; // Oculta la sección gastronómica
              }

              if (machineId || customLocation) {
                updateWhatsAppLink(
                  machineId,
                  machineData ? machineData.nombre : "",
                  machineData ? machineData.ubicacion : "",
                  customLocation
                );
              }
            });
          });
      });

      function toggleOrderSection() {
        const orderSection = document.getElementById("order-section");
        const toggleButton = document.querySelector(".show-order-button");

        // Verificar el estado actual de la sección y alternar
        if (orderSection.style.display === "block") {
          orderSection.style.display = "none";
          toggleButton.textContent = "Armá tu pedido gastronómico";
          toggleButton.style.backgroundColor = "#25D366"; // Volver al color original cuando está cerrado
        } else {
          orderSection.style.display = "block";
          toggleButton.textContent = "Cerrar carta digital";
          toggleButton.style.backgroundColor = "#ff4444"; // Cambiar el color del botón cuando está abierto
        }
      }
    </script>
  </head>
  <body>
    <div class="vip-title">
      <h1>Experiencia Diamond</h1>
    </div>

    <div class="menu">
      <img src="./img/carta_diamond.jpg" alt="Menu Platinum" />
    </div>
    <div class="steps">
      <h3>Pasos para solicitar servicio:</h3>
      <div class="step">
        <div class="step-text">
          <i class="fas fa-keyboard"></i>
          Ingrese el número de la máquina o su ubicación manualmente
        </div>
      </div>
      <div class="step">
        <div class="step-text">
          <i class="fas fa-search"></i>
          Presione el botón de ingresar ubicación
        </div>
      </div>
      <div class="step">
        <div class="step-text">
          <i class="fab fa-whatsapp"></i>
          Presione el botón de WhatsApp del servicio que desee solicitar
        </div>
      </div>
    </div>
    <div class="input-container">
      <input
        type="text"
        id="machineId"
        placeholder="Ingrese el número de la máquina"
        oninput="checkInput('machine')"
      />
      <textarea
        id="customLocation"
        placeholder="O ingrese su ubicación manualmente"
        oninput="checkInput('location')"
      ></textarea>
      <button onclick="fetchMachineInfo()">Ingresar Ubicación</button>
      <div class="confirm-message">¡Ubicación registrada!</div>
    </div>
    <div class="alert-message" id="alert-message"></div>
    <div class="game-name" id="game-name"></div>
    <div class="next-step">
      Ahora, arme su pedido o presione el botón de WhatsApp para solicitar un
      servicio.
    </div>
    <div id="order-section">
      <div class="items-container">
        <h3>Seleccione los ítems de la carta:</h3>
        <div class="items-column">
            <div>
                <h4>Bebidas sin alcohol:</h4>
                <label><input type="checkbox" value="Agua con o sin gas"> Agua con o sin gas</label>
                <label><input type="checkbox" value="Gaseosas"> Gaseosas</label>
                <label><input type="checkbox" value="Aguas saborizadas"> Aguas saborizadas</label>
    
                <h4>Bebidas con alcohol:</h4>
                <label><input type="checkbox" value="Copa de Chandon"> Copa de Chandon</label>
    
                <h4>Salado:</h4>
                <div class="salado-columns">
                    <div>
                        <label><input type="checkbox" value="Tostado árabe de jamón y queso"> Tostado árabe de jamón y queso</label>
                        <label><input type="checkbox" value="Tostado de miga de jamón y queso"> Tostado de miga de jamón y queso</label>
                        <label><input type="checkbox" value="Sandwich de jamón crudo"> Sandwich de jamón crudo</label>
                        <label><input type="checkbox" value="Sandwich de pollo"> Sandwich de pollo</label>
                        <label><input type="checkbox" value="Ensalada Caesar"> Ensalada Caesar</label>
                        <label><input type="checkbox" value="Ensalada tibia de salmón"> Ensalada tibia de salmón</label>
                    </div>
                    <div>
                        <label><input type="checkbox" value="Pizza Muzzarella"> Pizza Muzzarella</label>
                        <label><input type="checkbox" value="Pizza Margarita"> Pizza Margarita</label>
                        <label><input type="checkbox" value="Plato de quesos"> Plato de quesos</label>
                        <label><input type="checkbox" value="Bagel de salmón"> Bagel de salmón (12:00 a 02:00 HS)</label>
                        <label><input type="checkbox" value="Hamburguesa completa"> Hamburguesa completa (12:00 a 02:00 HS)</label>
                        <label><input type="checkbox" value="Sorrentinos capresse"> Sorrentinos capresse con salsa rosa (12:00 a 02:00 HS)</label>
                    </div>
                    <div>
                        <label><input type="checkbox" value="Solomillo envuelto en panceta"> Solomillo envuelto en panceta con papines al romero (12:00 a 02:00 HS)</label>
                        <label><input type="checkbox" value="Pulled pork"> Pulled pork (12:00 a 02:00 HS)</label>
                    </div>
                </div>
    
                <h4>Cafetería:</h4>
                <label><input type="checkbox" value="Café chico"> Café chico</label>
                <label><input type="checkbox" value="Café americano"> Café americano</label>
                <label><input type="checkbox" value="Café doble"> Café doble</label>
                <label><input type="checkbox" value="Capuchino"> Capuchino</label>
                <label><input type="checkbox" value="Submarino"> Submarino</label>
    
                <h4>Panificados:</h4>
                <label><input type="checkbox" value="Medialuna manteca"> Medialuna manteca</label>
                <label><input type="checkbox" value="Medialuna grasa"> Medialuna grasa</label>
            </div>
            <div>
                <h4>Postres:</h4>
                <label><input type="checkbox" value="Postre Óreo"> Postre Óreo</label>
                <label><input type="checkbox" value="Copa Barcarce"> Copa Barcarce</label>
            </div>
        </div>
    </div>
      </div>
    </div>

    <div id="location" class="location-info"></div>
    
    <div class="section">
      <button class="show-order-button" onclick="toggleOrderSection()">
        Armá tu pedido gastronómico
      </button>

      <div class="section-gastro">
        <h3>Solicite servicio gastronómico:</h3>
        <div class="whatsapp-icon whatsapp-icon-service" id="whatsappButton">
          <a href="https://wa.me/541121632583" target="_blank">
            <i class="fab fa-whatsapp"></i>
          </a>
        </div>
      </div>
    </div>

    <div class="section">
      <h3>Solicite la compra de tickets:</h3>
      <div class="whatsapp-icon whatsapp-icon-ticket" id="whatsappTicketButton">
        <a href="https://wa.me/541160971695" target="_blank">
          <i class="fab fa-whatsapp"></i>
        </a>
      </div>
    </div>
    <div class="section">
      <h3>Solicite limpieza:</h3>
      <div class="whatsapp-icon whatsapp-icon-cleaning" id="whatsappCleaningtButton">
        <a href="https://wa.me/541135457224" target="_blank">
          <i class="fab fa-whatsapp"></i>
        </a>
      </div>
    </div>
    <div class="section">
      <h3>Solicite asistencia Prefer:</h3>
      <div class="whatsapp-icon whatsapp-icon-assistance" id="whatsappPrefertButton">
        <a href="https://wa.me/541122217990" target="_blank">
          <i class="fab fa-whatsapp"></i>
        </a>
      </div>
    </div>

    <div class="betfun-section">
      <h3>Accede a Betfun</h3>
      <p>Disfruta de la mejor experiencia de casino online en Betfun.</p>
      <p>Visitanos!</p>
      <a href="https://betfun.bet.ar/" target="_blank" class="whatsappBFtButton">
        <img src="./img/betfun.png" alt="Betfun" class="betfun-image" />
      </a>
      <!-- <p>Quiero contactarme</p>
      <div class="whatsapp-icon whatsapp-icon-betfun enabled">
        <a
          href="https://wa.me/541124618288?text=Hola! 👋 Soy Diamond! Quiero mas información sobre BetFun. Gracias! 😊;"
          target="_blank"
        >
          <i class="fab fa-whatsapp"></i>
        </a>
      </div> -->
    </div>

    <div class="chatbot-section">
      <h3>Habla con Sloti</h3>
      <p class="sloti-description">
        Sloti está aquí para ayudarte con cualquier consulta o asistencia que
        necesites durante tu experiencia.
      </p>
    
      <!-- Imagen de Sloti como botón de WhatsApp -->
      <a href="https://wa.me/541166798216?text=Hola%20Sloti!" target="_blank" class="whatsappSlotiButton">
        <img src="./img/sloti.png" alt="Sloti" class="sloti-image" />
      </a>
    
      <!-- Ícono de WhatsApp con el mismo enlace -->
      <div class="whatsapp-icon whatsapp-icon-sloti">
        <a href="https://wa.me/541166798216?text=Hola%20Sloti!" target="_blank" class="whatsappSlotiButton">
          <i class="fab fa-whatsapp"></i>
        </a>
      </div>
    </div>
    
    


    <script type="module">
      // Import the function from logUsage.js
      import { logUsage } from './js/logUsage.js';


       // Función para mostrar el modal de captura de clientName y ejecutar la acción de WhatsApp
        async function showClientNameModal() {
          // Mostrar el modal para capturar el nombre del cliente
          const { value: clientName } = await Swal.fire({
            title: 'Ingrese su nombre para una mejor experiencia',
            input: 'text',
            inputPlaceholder: 'Nombre del cliente',
            showCancelButton: true,
            confirmButtonText: 'Confirmar',
            cancelButtonText: 'Omitir'
          });

          return clientName;
        }


// Function to create message content based on the service type
function getMessageContent(serviceType, clientName) {
      const machineId = document.getElementById("machineId").value || null;
      const customLocation = document.getElementById("customLocation").value || null;
      const machineName = machineData ? machineData.nombre : null; // Asegura que el nombre de la máquina se incluya
      const clientType = 'Diamond'; 
      const selectedItems = Array.from(
          document.querySelectorAll('.items-container input[type="checkbox"]:checked')
      ).map(item => item.value).join(", ");

      // Format client name only if it's provided
  const clientGreeting = clientName && clientName !== undefined ? `Soy ${clientName}, ` : ""; 
  let message = '';

  if (serviceType === 'Gastronomía') {
    if (machineId) {
      message = `Hola! ${clientGreeting}necesito hacer un pedido en la máquina ${machineId}. Servicio: ${serviceType}. Pedido: ${selectedItems}. Gracias!`;
    } else if (customLocation) {
      message = `Hola! ${clientGreeting}necesito hacer un pedido en ${customLocation}. Servicio: ${serviceType}. Pedido: ${selectedItems}. Gracias!`;
    }
  } else if (serviceType === 'Compra de Ticket') {
    if (machineId) {
      message = `Hola! ${clientGreeting}necesito comprar tickets en la máquina ${machineId}. Servicio: ${serviceType}. Gracias!`;
    } else if (customLocation) {
      message = `Hola! ${clientGreeting}necesito comprar tickets en ${customLocation}. Servicio: ${serviceType}. Gracias!`;
    }
  } else if (serviceType === 'Limpieza') {
    if (machineId) {
      message = `Hola! ${clientGreeting}necesito Limpieza en la máquina ${machineId}. Servicio: ${serviceType}. Gracias!`;
    } else if (customLocation) {
      message = `Hola! ${clientGreeting}necesito Limpieza en ${customLocation}. Servicio: ${serviceType}. Gracias!`;
    }
  } else if (serviceType === 'Prefer') {
    if (machineId) {
      message = `Hola! ${clientGreeting}necesito servicio Prefer en la máquina ${machineId}. Servicio: ${serviceType}. Gracias!`;
    } else if (customLocation) {
      message = `Hola! ${clientGreeting}necesito servicio Prefer en ${customLocation}. Servicio: ${serviceType}. Gracias!`;
    }
  }

  return { machineId, machineName, customLocation, clientType, serviceRequested: serviceType, message, selectedItems };
}

    
      // Function to redirect to WhatsApp
      function openWhatsAppLink(whatsappUrl) {
          window.location.href = whatsappUrl; 
      }
    
      // Listener para el botón de 'Gastronomía'
        document.getElementById("whatsappButton").addEventListener("click", async (e) => {
            e.preventDefault();
            
            // Capturar el nombre del cliente usando el modal
            const clientName = await showClientNameModal();

            // Obtener logData y añadir clientName
            const { message, ...logData } = getMessageContent('Gastronomía');
            logData.clientName = clientName;  // Añadir clientName a logData

            // Redirigir a WhatsApp con el mensaje
            openWhatsAppLink(`https://wa.me/541121632583?text=${encodeURIComponent(message)}`);

            // Enviar logData al backend
            logUsage(logData).catch(console.error);
        });



    
     // Listener para el botón de 'Compra de Ticket'
      document.getElementById("whatsappTicketButton").addEventListener("click", async (e) => {
          e.preventDefault();
          const clientName = await showClientNameModal();

          console.log(clientName);

          // Obtener logData desde getMessageContent y añadir clientName
          const { message, ...logData } = getMessageContent('Compra de Ticket', clientName);
          logData.clientName = clientName;  // Añadir clientName a logData

          // Redirigir a WhatsApp con el mensaje
          openWhatsAppLink(`https://wa.me/541160971695?text=${encodeURIComponent(message)}`);

          // Enviar logData al backend
          logUsage(logData).catch(console.error);
      });


       // Listener para el botón de 'Limpieza'
        document.getElementById("whatsappCleaningtButton").addEventListener("click", async (e) => {
            e.preventDefault();
            
            // Capturar el nombre del cliente usando el modal
            const clientName = await showClientNameModal();

            // Obtener logData y añadir clientName
            const { message, ...logData } = getMessageContent('Limpieza');
            logData.clientName = clientName;  // Añadir clientName a logData

            // Redirigir a WhatsApp con el mensaje
            openWhatsAppLink(`https://wa.me/1135457224?text=${encodeURIComponent(message)}`);

            // Enviar logData al backend
            logUsage(logData).catch(console.error);
        });



      // Listener para el botón de 'Prefer'
      document.getElementById("whatsappPrefertButton").addEventListener("click", async (e) => {
          e.preventDefault();
          
          // Capturar el nombre del cliente usando el modal
          const clientName = await showClientNameModal();

          // Obtener logData y añadir clientName
          const { message, ...logData } = getMessageContent('Prefer');
          logData.clientName = clientName;  // Añadir clientName a logData

          // Redirigir a WhatsApp con el mensaje
          openWhatsAppLink(`https://wa.me/541122217990?text=${encodeURIComponent(message)}`);

          // Enviar logData al backend
          logUsage(logData).catch(console.error);
      });


      // Listener for 'Sloti'

        document.querySelectorAll('.whatsappSlotiButton').forEach(button => {
          button.addEventListener('click', function (event) {
          event.preventDefault(); // Usar event, no 'e'

          console.log('sloti');
          
    
          const {clientType, serviceRequested, message} = getMessageContent('Sloti'); 
    
          // Redirect to WhatsApp immediately
          openWhatsAppLink(`https://wa.me/541122217990?text=${encodeURIComponent(message)}`);
    
          // Log the usage in the background
          logUsage({clientType, serviceRequested, message}).catch(console.error);
      })}) 
      
      
      // Listener for 'BetFun'

      document.querySelectorAll('.whatsappBFtButton').forEach(button => {
          button.addEventListener('click', function (event) {
          event.preventDefault(); // Usar event, no 'e'

          console.log('BF');
          
    
          const {clientType, serviceRequested, message} = getMessageContent('BetFun'); 
    
          // Log the usage in the background
          logUsage({clientType, serviceRequested, message}).catch(console.error);

            // Redirigir a la página de BetFun
            window.location.href = "https://betfun.bet.ar";
      })})    


      </script>
    
  </body>
</html>
